# BoLuo (è è) ğŸ“¸

[![npm version](https://badge.fury.io/js/boluo.svg)](https://badge.fury.io/js/boluo)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![TypeScript](https://img.shields.io/badge/TypeScript-Ready-blue.svg)](https://www.typescriptlang.org/)

## ğŸŒ Languages / è¯­è¨€

- [ğŸ‡¨ğŸ‡³ ä¸­æ–‡](#ä¸­æ–‡ç‰ˆæœ¬)
- [ğŸ‡ºğŸ‡¸ English](#english-version)
- [ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª](#æ—¥æœ¬èªç‰ˆ)
- [ğŸ‡°ğŸ‡· í•œêµ­ì–´](#í•œêµ­ì–´-ë²„ì „)

---

## ä¸­æ–‡ç‰ˆæœ¬

> TypeScript ç‰ˆæœ¬çš„ Luban å›¾ç‰‡å‹ç¼©åº“ï¼ŒåŸºäºå¾®ä¿¡æœ‹å‹åœˆå‹ç¼©ç®—æ³•

BoLuo æ˜¯ [Android Luban](https://github.com/Curzibn/Luban) å‹ç¼©ç®—æ³•çš„ TypeScript å®ç°ç‰ˆæœ¬ï¼Œä¸“ä¸º Node.js ç¯å¢ƒè®¾è®¡ã€‚Luban ç®—æ³•é€šè¿‡é€†å‘åˆ†æå¾®ä¿¡æœ‹å‹åœˆçš„å›¾ç‰‡å‹ç¼©ç­–ç•¥è€Œæ¥ï¼Œèƒ½å¤Ÿåœ¨ä¿æŒè§†è§‰è´¨é‡çš„åŒæ—¶æ˜¾è‘—å‡å°å›¾ç‰‡æ–‡ä»¶å¤§å°ã€‚<mcreference link="https://github.com/Curzibn/Luban" index="0">0</mcreference>

## ğŸ¯ å…³äº Luban ç®—æ³•

Lubanï¼ˆé²ç­ï¼‰ç®—æ³•æ˜¯é€šè¿‡åœ¨å¾®ä¿¡æœ‹å‹åœˆå‘é€è¿‘100å¼ ä¸åŒåˆ†è¾¨ç‡å›¾ç‰‡ï¼Œå¯¹æ¯”åŸå›¾ä¸å¾®ä¿¡å‹ç¼©åçš„å›¾ç‰‡é€†å‘æ¨ç®—å‡ºæ¥çš„å‹ç¼©ç®—æ³•ã€‚<mcreference link="https://github.com/Curzibn/Luban" index="0">0</mcreference> è™½ç„¶æ˜¯é€†å‘æ¨ç®—ï¼Œä½†æ•ˆæœå·²ç»éå¸¸æ¥è¿‘å¾®ä¿¡æœ‹å‹åœˆå‹ç¼©åçš„æ•ˆæœã€‚

### å‹ç¼©æ•ˆæœå¯¹æ¯”

| å†…å®¹ | åŸå›¾ | Luban å‹ç¼© | å¾®ä¿¡å‹ç¼© |
|------|------|------------|----------|
| æˆªå± 720P | 720Ã—1280, 390KB | 720Ã—1280, 87KB | 720Ã—1280, 56KB |
| æˆªå± 1080P | 1080Ã—1920, 2.21MB | 1080Ã—1920, 104KB | 1080Ã—1920, 112KB |
| æ‹ç…§ 13M(4:3) | 3096Ã—4128, 3.12MB | 1548Ã—2064, 141KB | 1548Ã—2064, 147KB |
| æ‹ç…§ 9.6M(16:9) | 4128Ã—2322, 4.64MB | 1032Ã—581, 97KB | 1032Ã—581, 74KB |

*æ•°æ®æ¥æºï¼šAndroid Luban é¡¹ç›®æµ‹è¯•ç»“æœ*<mcreference link="https://github.com/Curzibn/Luban" index="0">0</mcreference>

## âœ¨ ç‰¹æ€§

- ğŸš€ **å¾®ä¿¡çº§å‹ç¼©ç®—æ³•** - åŸºäºé€†å‘åˆ†æå¾®ä¿¡æœ‹å‹åœˆå‹ç¼©ç­–ç•¥
- ğŸ“¦ **TypeScript åŸç”Ÿæ”¯æŒ** - å®Œæ•´çš„ç±»å‹å®šä¹‰ï¼Œä¼˜ç§€çš„å¼€å‘ä½“éªŒ
- ğŸ”§ **é«˜æ€§èƒ½å¤„ç†** - åŸºäº Sharp å¼•æ“ï¼Œæä¾›å¿«é€Ÿçš„å›¾ç‰‡å¤„ç†èƒ½åŠ›
- ğŸ¯ **æ™ºèƒ½å‹ç¼©ç­–ç•¥** - è‡ªåŠ¨è®¡ç®—æœ€ä½³å‹ç¼©å‚æ•°ï¼Œå¹³è¡¡æ–‡ä»¶å¤§å°ä¸å›¾ç‰‡è´¨é‡
- ğŸ“ **æ‰¹é‡å¤„ç†æ”¯æŒ** - æ”¯æŒå•æ–‡ä»¶å’Œæ‰¹é‡æ–‡ä»¶å‹ç¼©
- ğŸ¨ **é€æ˜é€šé“ä¿æŒ** - å¯é€‰æ‹©ä¿ç•™ PNG å›¾ç‰‡çš„é€æ˜é€šé“
- ğŸ“Š **è¯¦ç»†å‹ç¼©ç»Ÿè®¡** - æä¾›å‹ç¼©å‰åçš„è¯¦ç»†å¯¹æ¯”æ•°æ®
- ğŸ” **çµæ´»è¿‡æ»¤æœºåˆ¶** - æ”¯æŒè‡ªå®šä¹‰æ–‡ä»¶è¿‡æ»¤å’Œé‡å‘½åè§„åˆ™

## ğŸ“¦ å®‰è£…

```bash
npm install boluo-image
```

æˆ–ä½¿ç”¨ yarn:

```bash
yarn add boluo-image
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### åŸºç¡€ç”¨æ³•

```typescript
import BoLuo from 'boluo-image';

// å‹ç¼©å•ä¸ªæ–‡ä»¶
const result = await BoLuo.compressFile('./input/image.jpg');
console.log(`å‹ç¼©å®Œæˆ: ${result.originalSize} -> ${result.compressedSize} bytes`);
console.log(`å‹ç¼©æ¯”: ${result.compressionRatio.toFixed(2)}%`);

// å‹ç¼©å¤šä¸ªæ–‡ä»¶
const results = await BoLuo.compressFiles([
  './input/image1.jpg',
  './input/image2.png'
]);
```

### ä½¿ç”¨æ„å»ºå™¨æ¨¡å¼

```typescript
import { BoLuo } from 'boluo-image';

const result = await BoLuo.create()
  .load('./input/image.jpg')
  .quality(80)                    // è®¾ç½®å‹ç¼©è´¨é‡ (0-100)
  .ignoreBy(100)                  // å°äº100KBçš„æ–‡ä»¶ä¸å‹ç¼©
  .setTargetDir('./output')       // è®¾ç½®è¾“å‡ºç›®å½•
  .setFocusAlpha(true)           // ä¿ç•™é€æ˜é€šé“
  .get();

console.log('å‹ç¼©ç»“æœ:', result);
```

### æ‰¹é‡å‹ç¼©ä¸ç›‘å¬

```typescript
import { BoLuo } from 'boluo-image';

await BoLuo.create()
  .load(['./images/*.jpg', './images/*.png'])
  .quality(75)
  .setTargetDir('./compressed')
  .filter(filePath => !filePath.includes('thumbnail')) // è¿‡æ»¤æ–‡ä»¶
  .setCompressListener({
    onStart: () => console.log('å¼€å§‹å‹ç¼©...'),
    onSuccess: (outputPath) => console.log(`å‹ç¼©æˆåŠŸ: ${outputPath}`),
    onError: (error) => console.error('å‹ç¼©å¤±è´¥:', error)
  })
  .launch();
```

### é«˜çº§ç”¨æ³• - è‡ªå®šä¹‰é‡å‘½å

```typescript
import { BoLuo } from 'boluo-image';

const result = await BoLuo.create()
  .load('./input/photo.jpg')
  .setTargetDir('./output')
  .setRenameListener((originalPath) => {
    const timestamp = Date.now();
    return `compressed_${timestamp}_${path.basename(originalPath)}`;
  })
  .get();
```

## ğŸ“– API æ–‡æ¡£

### BoLuo ç±»

#### é™æ€æ–¹æ³•

- `BoLuo.create()`: åˆ›å»º BoLuoBuilder å®ä¾‹
- `BoLuo.compressFile(filePath, options?)`: å‹ç¼©å•ä¸ªæ–‡ä»¶
- `BoLuo.compressFiles(filePaths, options?)`: å‹ç¼©å¤šä¸ªæ–‡ä»¶

### BoLuoBuilder ç±»

#### é…ç½®æ–¹æ³•

| æ–¹æ³• | å‚æ•° | æè¿° |
|------|------|------|
| `load(input)` | `string \| string[] \| Buffer` | åŠ è½½æ–‡ä»¶è·¯å¾„ã€è·¯å¾„æ•°ç»„æˆ– Buffer |
| `quality(quality)` | `number (0-100)` | è®¾ç½®å‹ç¼©è´¨é‡ï¼Œé»˜è®¤ 60 |
| `ignoreBy(size)` | `number` | è®¾ç½®æœ€å°å‹ç¼©é˜ˆå€¼ (KB)ï¼Œé»˜è®¤ 100 |
| `setFocusAlpha(focusAlpha)` | `boolean` | æ˜¯å¦ä¿ç•™é€æ˜é€šé“ï¼Œé»˜è®¤ false |
| `setTargetDir(targetDir)` | `string` | è®¾ç½®è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ './compressed' |
| `filter(filterFn)` | `(filePath: string) => boolean` | è®¾ç½®æ–‡ä»¶è¿‡æ»¤å™¨ |
| `setRenameListener(renameFn)` | `(filePath: string) => string` | è®¾ç½®é‡å‘½åå›è°ƒ |
| `setCompressListener(listener)` | `CompressionListener` | è®¾ç½®å‹ç¼©ç›‘å¬å™¨ |

#### æ‰§è¡Œæ–¹æ³•

- `get()`: å‹ç¼©å¹¶è¿”å›å•ä¸ªç»“æœ
- `getAll()`: å‹ç¼©å¹¶è¿”å›æ‰€æœ‰ç»“æœ
- `launch()`: æ‰§è¡Œå‹ç¼©ï¼ˆæ— è¿”å›å€¼ï¼‰

### ç±»å‹å®šä¹‰

```typescript
interface CompressionOptions {
  quality?: number;           // å‹ç¼©è´¨é‡ (0-100)
  ignoreBy?: number;         // æœ€å°å‹ç¼©é˜ˆå€¼ (KB)
  focusAlpha?: boolean;      // æ˜¯å¦ä¿ç•™é€æ˜é€šé“
  targetDir?: string;        // è¾“å‡ºç›®å½•
  renameListener?: (filePath: string) => string;
  filter?: (filePath: string) => boolean;
}

interface CompressionResult {
  originalPath: string;      // åŸå§‹æ–‡ä»¶è·¯å¾„
  outputPath: string;        // è¾“å‡ºæ–‡ä»¶è·¯å¾„
  originalSize: number;      // åŸå§‹æ–‡ä»¶å¤§å° (bytes)
  compressedSize: number;    // å‹ç¼©åæ–‡ä»¶å¤§å° (bytes)
  compressionRatio: number;  // å‹ç¼©æ¯”ä¾‹ (0-100)
  width: number;             // å›¾ç‰‡å®½åº¦
  height: number;            // å›¾ç‰‡é«˜åº¦
}

interface CompressionListener {
  onStart?: () => void;                    // å‹ç¼©å¼€å§‹
  onSuccess?: (outputPath: string) => void; // å‹ç¼©æˆåŠŸ
  onError?: (error: Error) => void;        // å‹ç¼©å¤±è´¥
}
```

## ğŸ”§ é…ç½®é€‰é¡¹

| é€‰é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | æè¿° |
|------|------|--------|------|
| `quality` | number | 60 | å‹ç¼©è´¨é‡ï¼ŒèŒƒå›´ 0-100ï¼Œæ•°å€¼è¶Šé«˜è´¨é‡è¶Šå¥½ |
| `ignoreBy` | number | 100 | æœ€å°å‹ç¼©é˜ˆå€¼(KB)ï¼Œå°äºæ­¤å€¼çš„æ–‡ä»¶ä¸è¿›è¡Œå‹ç¼© |
| `focusAlpha` | boolean | false | æ˜¯å¦ä¿ç•™ PNG å›¾ç‰‡çš„é€æ˜é€šé“ |
| `targetDir` | string | './compressed' | å‹ç¼©åå›¾ç‰‡çš„è¾“å‡ºç›®å½•è·¯å¾„ |
| `filter` | function | æ’é™¤ GIF | æ–‡ä»¶è¿‡æ»¤å™¨å‡½æ•°ï¼Œè¿”å› true çš„æ–‡ä»¶ä¼šè¢«å‹ç¼© |

## ğŸ¯ ä½¿ç”¨åœºæ™¯

- **Web åç«¯æœåŠ¡** - å¤„ç†ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡ï¼Œå‡å°‘å­˜å‚¨ç©ºé—´å’Œä¼ è¾“æ—¶é—´
- **å†…å®¹ç®¡ç†ç³»ç»Ÿ** - è‡ªåŠ¨å‹ç¼©ä¸Šä¼ çš„å›¾ç‰‡èµ„æº
- **å›¾ç‰‡å¤„ç†æœåŠ¡** - æä¾›å›¾ç‰‡å‹ç¼© API æœåŠ¡
- **æ‰¹é‡å›¾ç‰‡å¤„ç†** - å¯¹å¤§é‡å†å²å›¾ç‰‡è¿›è¡Œæ‰¹é‡å‹ç¼©
- **æ„å»ºå·¥å…·é›†æˆ** - åœ¨é¡¹ç›®æ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨ä¼˜åŒ–å›¾ç‰‡èµ„æº
- **ç§»åŠ¨ç«¯åå°** - ä¸ºç§»åŠ¨åº”ç”¨æä¾›é€‚åˆçš„å›¾ç‰‡å‹ç¼©æœåŠ¡

## ğŸ—ï¸ æ¶æ„è¯´æ˜

### ä¸å‰ç«¯çš„é…åˆä½¿ç”¨

```javascript
// å‰ç«¯ä¸Šä¼  (React/Vue/Angular ç­‰)
const uploadImage = async (file) => {
  const formData = new FormData();
  formData.append('image', file);
  
  const response = await fetch('/api/upload-and-compress', {
    method: 'POST',
    body: formData
  });
  
  return response.json();
};

// åç«¯å¤„ç† (Node.js + Express)
app.post('/api/upload-and-compress', upload.single('image'), async (req, res) => {
  try {
    const result = await BoLuo.compressFile(req.file.path, {
      quality: 75,
      targetDir: './public/compressed'
    });
    
    res.json({
      success: true,
      original: {
        size: result.originalSize,
        path: req.file.path
      },
      compressed: {
        size: result.compressedSize,
        path: result.outputPath,
        ratio: result.compressionRatio
      }
    });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});
```

## ğŸ”„ ä¸åŸç‰ˆ Android Luban çš„å¯¹åº”å…³ç³»

| Android Luban | BoLuo (TypeScript) | è¯´æ˜ |
|---------------|-------------------|------|
| `load()` | `load()` | åŠ è½½å›¾ç‰‡æ–‡ä»¶ |
| `ignoreBy()` | `ignoreBy()` | è®¾ç½®å‹ç¼©é˜ˆå€¼ |
| `setFocusAlpha()` | `setFocusAlpha()` | ä¿ç•™é€æ˜é€šé“ |
| `setTargetDir()` | `setTargetDir()` | è®¾ç½®è¾“å‡ºç›®å½• |
| `filter()` | `filter()` | æ–‡ä»¶è¿‡æ»¤å™¨ |
| `setCompressListener()` | `setCompressListener()` | å‹ç¼©ç›‘å¬å™¨ |
| `setRenameListener()` | `setRenameListener()` | é‡å‘½åç›‘å¬å™¨ |
| `launch()` | `launch()` | å¼‚æ­¥æ‰§è¡Œå‹ç¼© |
| `get()` | `get()` / `getAll()` | åŒæ­¥è·å–ç»“æœ |

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºä½ çš„ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤ä½ çš„ä¿®æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ä¸€ä¸ª Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

- æ„Ÿè°¢ [Curzibn/Luban](https://github.com/Curzibn/Luban) æä¾›çš„åŸå§‹ Android å‹ç¼©ç®—æ³•<mcreference link="https://github.com/Curzibn/Luban" index="0">0</mcreference>
- æ„Ÿè°¢ [Sharp](https://sharp.pixelplumbing.com/) æä¾›çš„å¼ºå¤§å›¾ç‰‡å¤„ç†èƒ½åŠ›
- æ„Ÿè°¢å¾®ä¿¡å›¢é˜Ÿçš„ä¼˜ç§€å‹ç¼©ç®—æ³•è®¾è®¡

## ğŸ”— ç›¸å…³é“¾æ¥

- [åŸç‰ˆ Android Luban](https://github.com/Curzibn/Luban) - åŸå§‹çš„ Android å›¾ç‰‡å‹ç¼©åº“
- [Sharp æ–‡æ¡£](https://sharp.pixelplumbing.com/) - åº•å±‚å›¾ç‰‡å¤„ç†å¼•æ“
- [å¾®ä¿¡æœ‹å‹åœˆå›¾ç‰‡å‹ç¼©ç®—æ³•åˆ†æ](https://github.com/Curzibn/Luban#é¡¹ç›®æè¿°) - ç®—æ³•åŸç†è¯´æ˜

---

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ª â­ï¸ï¼

---

## English Version

> TypeScript implementation of Luban image compression library, based on WeChat Moments compression algorithm

BoLuo is a TypeScript implementation of the [Android Luban](https://github.com/Curzibn/Luban) compression algorithm, designed specifically for Node.js environments. The Luban algorithm was reverse-engineered by analyzing WeChat Moments' image compression strategy, enabling significant file size reduction while maintaining visual quality.

## ğŸ¯ About Luban Algorithm

The Luban algorithm was reverse-engineered by sending nearly 100 images of different resolutions through WeChat Moments and comparing the original images with WeChat's compressed versions. Although it's reverse-engineered, the results are very close to WeChat Moments' compression effects.

### Compression Performance Comparison

| Content | Original | Luban Compressed | WeChat Compressed |
|---------|----------|------------------|-------------------|
| Screenshot 720P | 720Ã—1280, 390KB | 720Ã—1280, 87KB | 720Ã—1280, 56KB |
| Screenshot 1080P | 1080Ã—1920, 2.21MB | 1080Ã—1920, 104KB | 1080Ã—1920, 112KB |
| Photo 13M(4:3) | 3096Ã—4128, 3.12MB | 1548Ã—2064, 141KB | 1548Ã—2064, 147KB |
| Photo 9.6M(16:9) | 4128Ã—2322, 4.64MB | 1032Ã—581, 97KB | 1032Ã—581, 74KB |

*Data source: Android Luban project test results*

## âœ¨ Features

- ğŸš€ **WeChat-level compression algorithm** - Based on reverse analysis of WeChat Moments compression strategy
- ğŸ“¦ **Native TypeScript support** - Complete type definitions for excellent development experience
- ğŸ”§ **High-performance processing** - Based on Sharp engine for fast image processing
- ğŸ¯ **Smart compression strategy** - Automatically calculates optimal compression parameters, balancing file size and image quality
- ğŸ“ **Batch processing support** - Supports single file and batch file compression
- ğŸ¨ **Transparency preservation** - Optional preservation of PNG transparency channels
- ğŸ“Š **Detailed compression statistics** - Provides detailed comparison data before and after compression
- ğŸ” **Flexible filtering mechanism** - Supports custom file filtering and renaming rules

## ğŸ“¦ Installation

```bash
npm install boluo-image
```

Or using yarn:

```bash
yarn add boluo-image
```

## ğŸš€ Quick Start

### Basic Usage

```typescript
import BoLuo from 'boluo-image';

// Compress a single file
const result = await BoLuo.compressFile('./input/image.jpg');
console.log(`Compression completed: ${result.originalSize} -> ${result.compressedSize} bytes`);
console.log(`Compression ratio: ${result.compressionRatio.toFixed(2)}%`);

// Compress multiple files
const results = await BoLuo.compressFiles([
  './input/image1.jpg',
  './input/image2.png'
]);
```

### Using Builder Pattern

```typescript
import { BoLuo } from 'boluo-image';

const result = await BoLuo.create()
  .load('./input/image.jpg')
  .quality(80)                    // Set compression quality (0-100)
  .ignoreBy(100)                  // Don't compress files smaller than 100KB
  .setTargetDir('./output')       // Set output directory
  .setFocusAlpha(true)           // Preserve transparency channel
  .get();

console.log('Compression result:', result);
```

### Batch Compression with Listeners

```typescript
import { BoLuo } from 'boluo-image';

await BoLuo.create()
  .load(['./images/*.jpg', './images/*.png'])
  .quality(75)
  .setTargetDir('./compressed')
  .filter(filePath => !filePath.includes('thumbnail')) // Filter files
  .setCompressListener({
    onStart: () => console.log('Starting compression...'),
    onSuccess: (outputPath) => console.log(`Compression successful: ${outputPath}`),
    onError: (error) => console.error('Compression failed:', error)
  })
  .launch();
```

## ğŸ“– API Documentation

### BoLuo Class

#### Static Methods

- `BoLuo.create()`: Create BoLuoBuilder instance
- `BoLuo.compressFile(filePath, options?)`: Compress single file
- `BoLuo.compressFiles(filePaths, options?)`: Compress multiple files

### BoLuoBuilder Class

#### Configuration Methods

| Method | Parameters | Description |
|--------|------------|-------------|
| `load(input)` | `string \| string[] \| Buffer` | Load file path, path array, or Buffer |
| `quality(quality)` | `number (0-100)` | Set compression quality, default 60 |
| `ignoreBy(size)` | `number` | Set minimum compression threshold (KB), default 100 |
| `setFocusAlpha(focusAlpha)` | `boolean` | Whether to preserve transparency channel, default false |
| `setTargetDir(targetDir)` | `string` | Set output directory, default './compressed' |
| `filter(filterFn)` | `(filePath: string) => boolean` | Set file filter |
| `setRenameListener(renameFn)` | `(filePath: string) => string` | Set rename callback |
| `setCompressListener(listener)` | `CompressionListener` | Set compression listener |

#### Execution Methods

- `get()`: Compress and return single result
- `getAll()`: Compress and return all results
- `launch()`: Execute compression (no return value)

### Type Definitions

```typescript
interface CompressionOptions {
  quality?: number;           // Compression quality (0-100)
  ignoreBy?: number;         // Minimum compression threshold (KB)
  focusAlpha?: boolean;      // Whether to preserve transparency channel
  targetDir?: string;        // Output directory
  renameListener?: (filePath: string) => string;
  filter?: (filePath: string) => boolean;
}

interface CompressionResult {
  originalPath: string;      // Original file path
  outputPath: string;        // Output file path
  originalSize: number;      // Original file size (bytes)
  compressedSize: number;    // Compressed file size (bytes)
  compressionRatio: number;  // Compression ratio (0-100)
  width: number;             // Image width
  height: number;            // Image height
}

interface CompressionListener {
  onStart?: () => void;                    // Compression start
  onSuccess?: (outputPath: string) => void; // Compression success
  onError?: (error: Error) => void;        // Compression failure
}
```

## ğŸ”§ Configuration Options

| Option | Type | Default | Description |
|--------|------|---------|-------------|
| `quality` | number | 60 | Compression quality, range 0-100, higher values mean better quality |
| `ignoreBy` | number | 100 | Minimum compression threshold (KB), files smaller than this won't be compressed |
| `focusAlpha` | boolean | false | Whether to preserve PNG transparency channels |
| `targetDir` | string | './compressed' | Output directory path for compressed images |
| `filter` | function | Exclude GIF | File filter function, files returning true will be compressed |

## ğŸ¯ Use Cases

- **Web Backend Services** - Process user-uploaded images, reduce storage space and transfer time
- **Content Management Systems** - Automatically compress uploaded image resources
- **Image Processing Services** - Provide image compression API services
- **Batch Image Processing** - Batch compress large amounts of historical images
- **Build Tool Integration** - Automatically optimize image resources during project builds
- **Mobile Backend** - Provide suitable image compression services for mobile applications

## ğŸ¤ Contributing

Issues and Pull Requests are welcome!

1. Fork this repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ğŸ™ Acknowledgments

- Thanks to [Curzibn/Luban](https://github.com/Curzibn/Luban) for providing the original Android compression algorithm
- Thanks to [Sharp](https://sharp.pixelplumbing.com/) for providing powerful image processing capabilities
- Thanks to the WeChat team for their excellent compression algorithm design

## ğŸ”— Related Links

- [Original Android Luban](https://github.com/Curzibn/Luban) - The original Android image compression library
- [Sharp Documentation](https://sharp.pixelplumbing.com/) - Underlying image processing engine
- [WeChat Moments Image Compression Algorithm Analysis](https://github.com/Curzibn/Luban#é¡¹ç›®æè¿°) - Algorithm principle explanation

---

If this project helps you, please give it a â­ï¸!

---

## æ—¥æœ¬èªç‰ˆ

> WeChat ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒ„åœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«åŸºã¥ã Luban ç”»åƒåœ§ç¸®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã® TypeScript ç‰ˆ

BoLuo ã¯ [Android Luban](https://github.com/Curzibn/Luban) åœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã® TypeScript å®Ÿè£…ç‰ˆã§ã€Node.js ç’°å¢ƒå°‚ç”¨ã«è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚Luban ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ WeChat ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒ„ã®ç”»åƒåœ§ç¸®æˆ¦ç•¥ã‚’ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã—ã¦é–‹ç™ºã•ã‚Œã€è¦–è¦šçš„å“è³ªã‚’ä¿ã¡ãªãŒã‚‰ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚

## ğŸ¯ Luban ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã«ã¤ã„ã¦

Luban ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã¯ã€WeChat ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒ„ã«ç´„100æšã®ç•°ãªã‚‹è§£åƒåº¦ã®ç”»åƒã‚’é€ä¿¡ã—ã€å…ƒç”»åƒã¨ WeChat åœ§ç¸®å¾Œã®ç”»åƒã‚’æ¯”è¼ƒã—ã¦ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã§ç®—å‡ºã•ã‚ŒãŸåœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã§ã™ãŒã€åŠ¹æœã¯ WeChat ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒ„åœ§ç¸®å¾Œã®åŠ¹æœã«éå¸¸ã«è¿‘ã„ã§ã™ã€‚

### åœ§ç¸®åŠ¹æœæ¯”è¼ƒ

| å†…å®¹ | å…ƒç”»åƒ | Luban åœ§ç¸® | WeChat åœ§ç¸® |
|------|--------|------------|-------------|
| ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 720P | 720Ã—1280, 390KB | 720Ã—1280, 87KB | 720Ã—1280, 56KB |
| ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ 1080P | 1080Ã—1920, 2.21MB | 1080Ã—1920, 104KB | 1080Ã—1920, 112KB |
| å†™çœŸ 13M(4:3) | 3096Ã—4128, 3.12MB | 1548Ã—2064, 141KB | 1548Ã—2064, 147KB |
| å†™çœŸ 9.6M(16:9) | 4128Ã—2322, 4.64MB | 1032Ã—581, 97KB | 1032Ã—581, 74KB |

*ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼šAndroid Luban ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ†ã‚¹ãƒˆçµæœ*

## âœ¨ ç‰¹å¾´

- ğŸš€ **WeChat ãƒ¬ãƒ™ãƒ«åœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ** - WeChat ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒ„åœ§ç¸®æˆ¦ç•¥ã®ãƒªãƒãƒ¼ã‚¹ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã«åŸºã¥ã
- ğŸ“¦ **TypeScript ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆ** - å®Œå…¨ãªå‹å®šç¾©ã§å„ªã‚ŒãŸé–‹ç™ºä½“é¨“
- ğŸ”§ **é«˜æ€§èƒ½å‡¦ç†** - Sharp ã‚¨ãƒ³ã‚¸ãƒ³ãƒ™ãƒ¼ã‚¹ã§é«˜é€Ÿç”»åƒå‡¦ç†
- ğŸ¯ **ã‚¹ãƒãƒ¼ãƒˆåœ§ç¸®æˆ¦ç•¥** - æœ€é©ãªåœ§ç¸®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è‡ªå‹•è¨ˆç®—ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã¨ç”»è³ªã®ãƒãƒ©ãƒ³ã‚¹
- ğŸ“ **ãƒãƒƒãƒå‡¦ç†ã‚µãƒãƒ¼ãƒˆ** - å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã¨ãƒãƒƒãƒãƒ•ã‚¡ã‚¤ãƒ«åœ§ç¸®ã‚’ã‚µãƒãƒ¼ãƒˆ
- ğŸ¨ **é€æ˜ãƒãƒ£ãƒ³ãƒãƒ«ä¿æŒ** - PNG ç”»åƒã®é€æ˜ãƒãƒ£ãƒ³ãƒãƒ«ã‚’é¸æŠçš„ã«ä¿æŒ
- ğŸ“Š **è©³ç´°åœ§ç¸®çµ±è¨ˆ** - åœ§ç¸®å‰å¾Œã®è©³ç´°æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ã‚’æä¾›
- ğŸ” **æŸ”è»Ÿãªãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿæ§‹** - ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã¨ãƒªãƒãƒ¼ãƒŸãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆ

## ğŸ“¦ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install boluo-image
```

ã¾ãŸã¯ yarn ã‚’ä½¿ç”¨ï¼š

```bash
yarn add boluo-image
```

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### åŸºæœ¬çš„ãªä½¿ç”¨æ³•

```typescript
import BoLuo from 'boluo-image';

// å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã®åœ§ç¸®
const result = await BoLuo.compressFile('./input/image.jpg');
console.log(`åœ§ç¸®å®Œäº†: ${result.originalSize} -> ${result.compressedSize} bytes`);
console.log(`åœ§ç¸®ç‡: ${result.compressionRatio.toFixed(2)}%`);

// è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®åœ§ç¸®
const results = await BoLuo.compressFiles([
  './input/image1.jpg',
  './input/image2.png'
]);
```

### ãƒ“ãƒ«ãƒ€ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä½¿ç”¨

```typescript
import { BoLuo } from 'boluo-image';

const result = await BoLuo.create()
  .load('./input/image.jpg')
  .quality(80)                    // åœ§ç¸®å“è³ªã‚’è¨­å®š (0-100)
  .ignoreBy(100)                  // 100KBæœªæº€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯åœ§ç¸®ã—ãªã„
  .setTargetDir('./output')       // å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’è¨­å®š
  .setFocusAlpha(true)           // é€æ˜ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä¿æŒ
  .get();

console.log('åœ§ç¸®çµæœ:', result);
```

## ğŸ“– API ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

### BoLuo ã‚¯ãƒ©ã‚¹

#### é™çš„ãƒ¡ã‚½ãƒƒãƒ‰

- `BoLuo.create()`: BoLuoBuilder ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
- `BoLuo.compressFile(filePath, options?)`: å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åœ§ç¸®
- `BoLuo.compressFiles(filePaths, options?)`: è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åœ§ç¸®

### è¨­å®šã‚ªãƒ—ã‚·ãƒ§ãƒ³

| ã‚ªãƒ—ã‚·ãƒ§ãƒ³ | å‹ | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ | èª¬æ˜ |
|-----------|---|-----------|------|
| `quality` | number | 60 | åœ§ç¸®å“è³ªã€ç¯„å›² 0-100ã€å€¤ãŒé«˜ã„ã»ã©å“è³ªãŒè‰¯ã„ |
| `ignoreBy` | number | 100 | æœ€å°åœ§ç¸®é–¾å€¤(KB)ã€ã“ã®å€¤æœªæº€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯åœ§ç¸®ã•ã‚Œãªã„ |
| `focusAlpha` | boolean | false | PNG ç”»åƒã®é€æ˜ãƒãƒ£ãƒ³ãƒãƒ«ã‚’ä¿æŒã™ã‚‹ã‹ã©ã†ã‹ |
| `targetDir` | string | './compressed' | åœ§ç¸®å¾Œç”»åƒã®å‡ºåŠ›ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹ |

## ğŸ¯ ä½¿ç”¨ã‚±ãƒ¼ã‚¹

- **Web ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒã®å‡¦ç†ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®¹é‡ã¨è»¢é€æ™‚é–“ã®å‰Šæ¸›
- **ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ** - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”»åƒãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•åœ§ç¸®
- **ç”»åƒå‡¦ç†ã‚µãƒ¼ãƒ“ã‚¹** - ç”»åƒåœ§ç¸® API ã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›
- **ãƒãƒƒãƒç”»åƒå‡¦ç†** - å¤§é‡ã®å±¥æ­´ç”»åƒã®ãƒãƒƒãƒåœ§ç¸®
- **ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«çµ±åˆ** - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ“ãƒ«ãƒ‰éç¨‹ã§ã®ç”»åƒãƒªã‚½ãƒ¼ã‚¹è‡ªå‹•æœ€é©åŒ–

## ğŸ¤ è²¢çŒ®

Issue ã¨ Pull Request ã‚’æ­“è¿ã—ã¾ã™ï¼

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/AmazingFeature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add some AmazingFeature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/AmazingFeature`)
5. Pull Request ã‚’é–‹ã

## ğŸ“„ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ MIT ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã•ã‚Œã¦ã„ã¾ã™ - è©³ç´°ã¯ [LICENSE](LICENSE) ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã”è¦§ãã ã•ã„ã€‚

## ğŸ™ è¬è¾

- å…ƒã® Android åœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’æä¾›ã—ã¦ãã‚ŒãŸ [Curzibn/Luban](https://github.com/Curzibn/Luban) ã«æ„Ÿè¬
- å¼·åŠ›ãªç”»åƒå‡¦ç†æ©Ÿèƒ½ã‚’æä¾›ã—ã¦ãã‚ŒãŸ [Sharp](https://sharp.pixelplumbing.com/) ã«æ„Ÿè¬
- å„ªç§€ãªåœ§ç¸®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ è¨­è¨ˆã‚’ã—ãŸ WeChat ãƒãƒ¼ãƒ ã«æ„Ÿè¬

---

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒãŠå½¹ã«ç«‹ã¦ã°ã€â­ï¸ ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼

---

## í•œêµ­ì–´ ë²„ì „

> WeChat ëª¨ë©˜íŠ¸ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ ê¸°ë°˜ Luban ì´ë¯¸ì§€ ì••ì¶• ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ TypeScript ë²„ì „

BoLuoëŠ” [Android Luban](https://github.com/Curzibn/Luban) ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì˜ TypeScript êµ¬í˜„ ë²„ì „ìœ¼ë¡œ, Node.js í™˜ê²½ì„ ìœ„í•´ íŠ¹ë³„íˆ ì„¤ê³„ë˜ì—ˆìŠµë‹ˆë‹¤. Luban ì•Œê³ ë¦¬ì¦˜ì€ WeChat ëª¨ë©˜íŠ¸ì˜ ì´ë¯¸ì§€ ì••ì¶• ì „ëµì„ ì—­ê³µí•™í•˜ì—¬ ê°œë°œë˜ì—ˆìœ¼ë©°, ì‹œê°ì  í’ˆì§ˆì„ ìœ ì§€í•˜ë©´ì„œ ì´ë¯¸ì§€ íŒŒì¼ í¬ê¸°ë¥¼ í¬ê²Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## ğŸ¯ Luban ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•´

Luban ì•Œê³ ë¦¬ì¦˜ì€ WeChat ëª¨ë©˜íŠ¸ì— ì•½ 100ì¥ì˜ ì„œë¡œ ë‹¤ë¥¸ í•´ìƒë„ ì´ë¯¸ì§€ë¥¼ ì „ì†¡í•˜ê³ , ì›ë³¸ ì´ë¯¸ì§€ì™€ WeChat ì••ì¶• í›„ ì´ë¯¸ì§€ë¥¼ ë¹„êµí•˜ì—¬ ì—­ê³µí•™ìœ¼ë¡œ ì‚°ì¶œëœ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ì—­ê³µí•™ì´ì§€ë§Œ íš¨ê³¼ëŠ” WeChat ëª¨ë©˜íŠ¸ ì••ì¶• í›„ íš¨ê³¼ì™€ ë§¤ìš° ìœ ì‚¬í•©ë‹ˆë‹¤.

### ì••ì¶• íš¨ê³¼ ë¹„êµ

| ë‚´ìš© | ì›ë³¸ ì´ë¯¸ì§€ | Luban ì••ì¶• | WeChat ì••ì¶• |
|------|------------|------------|-------------|
| ìŠ¤í¬ë¦°ìƒ· 720P | 720Ã—1280, 390KB | 720Ã—1280, 87KB | 720Ã—1280, 56KB |
| ìŠ¤í¬ë¦°ìƒ· 1080P | 1080Ã—1920, 2.21MB | 1080Ã—1920, 104KB | 1080Ã—1920, 112KB |
| ì‚¬ì§„ 13M(4:3) | 3096Ã—4128, 3.12MB | 1548Ã—2064, 141KB | 1548Ã—2064, 147KB |
| ì‚¬ì§„ 9.6M(16:9) | 4128Ã—2322, 4.64MB | 1032Ã—581, 97KB | 1032Ã—581, 74KB |

*ë°ì´í„° ì¶œì²˜: Android Luban í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸ ê²°ê³¼*

## âœ¨ íŠ¹ì§•

- ğŸš€ **WeChat ìˆ˜ì¤€ ì••ì¶• ì•Œê³ ë¦¬ì¦˜** - WeChat ëª¨ë©˜íŠ¸ ì••ì¶• ì „ëµì˜ ì—­ê³µí•™ ë¶„ì„ ê¸°ë°˜
- ğŸ“¦ **TypeScript ë„¤ì´í‹°ë¸Œ ì§€ì›** - ì™„ì „í•œ íƒ€ì… ì •ì˜ë¡œ ìš°ìˆ˜í•œ ê°œë°œ ê²½í—˜
- ğŸ”§ **ê³ ì„±ëŠ¥ ì²˜ë¦¬** - Sharp ì—”ì§„ ê¸°ë°˜ìœ¼ë¡œ ë¹ ë¥¸ ì´ë¯¸ì§€ ì²˜ë¦¬
- ğŸ¯ **ìŠ¤ë§ˆíŠ¸ ì••ì¶• ì „ëµ** - ìµœì ì˜ ì••ì¶• ë§¤ê°œë³€ìˆ˜ ìë™ ê³„ì‚°, íŒŒì¼ í¬ê¸°ì™€ ì´ë¯¸ì§€ í’ˆì§ˆì˜ ê· í˜•
- ğŸ“ **ë°°ì¹˜ ì²˜ë¦¬ ì§€ì›** - ë‹¨ì¼ íŒŒì¼ ë° ë°°ì¹˜ íŒŒì¼ ì••ì¶• ì§€ì›
- ğŸ¨ **íˆ¬ëª…ë„ ì±„ë„ ìœ ì§€** - PNG ì´ë¯¸ì§€ì˜ íˆ¬ëª…ë„ ì±„ë„ ì„ íƒì  ìœ ì§€
- ğŸ“Š **ìƒì„¸ ì••ì¶• í†µê³„** - ì••ì¶• ì „í›„ì˜ ìƒì„¸ ë¹„êµ ë°ì´í„° ì œê³µ
- ğŸ” **ìœ ì—°í•œ í•„í„°ë§ ë©”ì»¤ë‹ˆì¦˜** - ì‚¬ìš©ì ì •ì˜ íŒŒì¼ í•„í„°ë§ ë° ì´ë¦„ ë³€ê²½ ê·œì¹™ ì§€ì›

## ğŸ“¦ ì„¤ì¹˜

```bash
npm install boluo-image
```

ë˜ëŠ” yarn ì‚¬ìš©:

```bash
yarn add boluo-image
```

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### ê¸°ë³¸ ì‚¬ìš©ë²•

```typescript
import BoLuo from 'boluo-image';

// ë‹¨ì¼ íŒŒì¼ ì••ì¶•
const result = await BoLuo.compressFile('./input/image.jpg');
console.log(`ì••ì¶• ì™„ë£Œ: ${result.originalSize} -> ${result.compressedSize} bytes`);
console.log(`ì••ì¶•ë¥ : ${result.compressionRatio.toFixed(2)}%`);

// ì—¬ëŸ¬ íŒŒì¼ ì••ì¶•
const results = await BoLuo.compressFiles([
  './input/image1.jpg',
  './input/image2.png'
]);
```

### ë¹Œë” íŒ¨í„´ ì‚¬ìš©

```typescript
import { BoLuo } from 'boluo-image';

const result = await BoLuo.create()
  .load('./input/image.jpg')
  .quality(80)                    // ì••ì¶• í’ˆì§ˆ ì„¤ì • (0-100)
  .ignoreBy(100)                  // 100KB ë¯¸ë§Œ íŒŒì¼ì€ ì••ì¶•í•˜ì§€ ì•ŠìŒ
  .setTargetDir('./output')       // ì¶œë ¥ ë””ë ‰í† ë¦¬ ì„¤ì •
  .setFocusAlpha(true)           // íˆ¬ëª…ë„ ì±„ë„ ìœ ì§€
  .get();

console.log('ì••ì¶• ê²°ê³¼:', result);
```

## ğŸ“– API ë¬¸ì„œ

### BoLuo í´ë˜ìŠ¤

#### ì •ì  ë©”ì„œë“œ

- `BoLuo.create()`: BoLuoBuilder ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
- `BoLuo.compressFile(filePath, options?)`: ë‹¨ì¼ íŒŒì¼ ì••ì¶•
- `BoLuo.compressFiles(filePaths, options?)`: ì—¬ëŸ¬ íŒŒì¼ ì••ì¶•

### ì„¤ì • ì˜µì…˜

| ì˜µì…˜ | íƒ€ì… | ê¸°ë³¸ê°’ | ì„¤ëª… |
|------|------|--------|------|
| `quality` | number | 60 | ì••ì¶• í’ˆì§ˆ, ë²”ìœ„ 0-100, ê°’ì´ ë†’ì„ìˆ˜ë¡ í’ˆì§ˆì´ ì¢‹ìŒ |
| `ignoreBy` | number | 100 | ìµœì†Œ ì••ì¶• ì„ê³„ê°’(KB), ì´ ê°’ ë¯¸ë§Œì˜ íŒŒì¼ì€ ì••ì¶•ë˜ì§€ ì•ŠìŒ |
| `focusAlpha` | boolean | false | PNG ì´ë¯¸ì§€ì˜ íˆ¬ëª…ë„ ì±„ë„ ìœ ì§€ ì—¬ë¶€ |
| `targetDir` | string | './compressed' | ì••ì¶•ëœ ì´ë¯¸ì§€ì˜ ì¶œë ¥ ë””ë ‰í† ë¦¬ ê²½ë¡œ |

## ğŸ¯ ì‚¬ìš© ì‚¬ë¡€

- **ì›¹ ë°±ì—”ë“œ ì„œë¹„ìŠ¤** - ì‚¬ìš©ì ì—…ë¡œë“œ ì´ë¯¸ì§€ ì²˜ë¦¬, ì €ì¥ ê³µê°„ ë° ì „ì†¡ ì‹œê°„ ë‹¨ì¶•
- **ì½˜í…ì¸  ê´€ë¦¬ ì‹œìŠ¤í…œ** - ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤ ìë™ ì••ì¶•
- **ì´ë¯¸ì§€ ì²˜ë¦¬ ì„œë¹„ìŠ¤** - ì´ë¯¸ì§€ ì••ì¶• API ì„œë¹„ìŠ¤ ì œê³µ
- **ë°°ì¹˜ ì´ë¯¸ì§€ ì²˜ë¦¬** - ëŒ€ëŸ‰ì˜ ê¸°ì¡´ ì´ë¯¸ì§€ ë°°ì¹˜ ì••ì¶•
- **ë¹Œë“œ ë„êµ¬ í†µí•©** - í”„ë¡œì íŠ¸ ë¹Œë“œ ê³¼ì •ì—ì„œ ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤ ìë™ ìµœì í™”

## ğŸ¤ ê¸°ì—¬

Issueì™€ Pull Requestë¥¼ í™˜ì˜í•©ë‹ˆë‹¤!

1. ì´ ì €ì¥ì†Œë¥¼ í¬í¬
2. ê¸°ëŠ¥ ë¸Œëœì¹˜ ìƒì„± (`git checkout -b feature/AmazingFeature`)
3. ë³€ê²½ ì‚¬í•­ ì»¤ë°‹ (`git commit -m 'Add some AmazingFeature'`)
4. ë¸Œëœì¹˜ì— í‘¸ì‹œ (`git push origin feature/AmazingFeature`)
5. Pull Request ì—´ê¸°

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë¼ì´ì„ ìŠ¤ê°€ ë¶€ì—¬ë©ë‹ˆë‹¤ - ìì„¸í•œ ë‚´ìš©ì€ [LICENSE](LICENSE) íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.

## ğŸ™ ê°ì‚¬ì˜ ë§

- ì›ë³¸ Android ì••ì¶• ì•Œê³ ë¦¬ì¦˜ì„ ì œê³µí•´ ì¤€ [Curzibn/Luban](https://github.com/Curzibn/Luban)ì— ê°ì‚¬
- ê°•ë ¥í•œ ì´ë¯¸ì§€ ì²˜ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•´ ì¤€ [Sharp](https://sharp.pixelplumbing.com/)ì— ê°ì‚¬
- ìš°ìˆ˜í•œ ì••ì¶• ì•Œê³ ë¦¬ì¦˜ ì„¤ê³„ë¥¼ í•œ WeChat íŒ€ì— ê°ì‚¬

---

ì´ í”„ë¡œì íŠ¸ê°€ ë„ì›€ì´ ë˜ì…¨ë‹¤ë©´ â­ï¸ë¥¼ ë¶€íƒë“œë¦½ë‹ˆë‹¤!